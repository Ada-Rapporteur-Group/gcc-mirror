fusion branch, based on subversion id 242456
