LIB2ADD=$(srcdir)/config/nvptx/malloc.asm \
	$(srcdir)/config/nvptx/free.asm \
	$(srcdir)/config/nvptx/realloc.c \
	$(srcdir)/config/nvptx/atomic.c

LIB2ADDEH=
LIB2FUNCS_EXCLUDE=__main

crt0.o: $(srcdir)/config/nvptx/crt0.s
	cp $< $@

# Prevent building "advanced" stuff (for example, gcov support).  We don't
# support it, and it may cause the build to fail, because of alloca usage, for
# example.
INHIBIT_LIBC_CFLAGS = -Dinhibit_libc

gomp-acc_on_device.o: $(srcdir)/config/nvptx/gomp-acc_on_device.c
	$(gcc_compile) -c -fno-builtin-acc_on_device $<
gomp-atomic.o: $(srcdir)/config/nvptx/gomp-atomic.asm
	cp $< $@

OBJS_libgomp= gomp-acc_on_device.o gomp-atomic.o
libgomp.a: $(OBJS_libgomp)
	$(AR_CREATE_FOR_TARGET) $@ $(OBJS_libgomp)
libgomp.spec:
	echo "*link_gomp: -lgomp" >$@
