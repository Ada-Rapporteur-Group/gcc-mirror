amo branch, based on subversion id 253461.
