# upc/config-lang.in: GNU UPC runtime library top-level configure fragment

# Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,
# 2009, 2010, 2011
# Free Software Foundation, Inc.
# Contributed by Gary Funck <gary@intrepid.com>
#   and Nenad Vukicevic <nenad@intrepid.com>.
# Based on original implementation
#   by Jesse M. Draper <jdraper@super.org>
#   and William W. Carlson <wwc@super.org>.
# Derived from objc/config-lang.in

# This file is part of GCC.

# GCC is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3, or (at your option)
# any later version.

# GCC is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with GCC; see the file COPYING3.  If not see
# <http://www.gnu.org/licenses/>.

# Configure looks for the existence of this file to auto-config each language.
# We define several parameters used by configure:
#
# language	- name of language as it would appear in $(LANGUAGES)
# compilers	- value to add to $(COMPILERS)
# stagestuff	- files to add to $(STAGESTUFF)

language="upc"

build_by_default="yes"

compilers="cc1upc\$(exeext)"

stagestuff="cc1upc\$(exeext)"

target_libs="target-libupc"

gtfiles="\$(srcdir)/upc/upc-act.h \$(srcdir)/upc/upc-act.c \$(srcdir)/c-tree.h \$(srcdir)/c-decl.c \$(srcdir)/c-family/c-common.c \$(srcdir)/c-family/c-common.h \$(srcdir)/c-family/c-pragma.h \$(srcdir)/c-family/c-pragma.c \$(srcdir)/c-objc-common.c \$(srcdir)/c-parser.c"

#
# UPC specific configuration definitions
#
for v in tm_include_list tm_file_list
do
  cfiles="config/upc-conf.h"
  upc_extra_parts="upc-crtbegin.o upc-crtbeginS.o upc-crtbeginT.o upc-crtend.o upc-crtendS.o upc-crtendT.o"
  case $build in
  alpha*-*-unicosmk*)
  	cfiles="${cfiles} config/alpha/upc-unicosmk.h"
	;;
  i[356]86-*-darwin*)
  	# cfiles="${cfiles} i386/upc-linux.h"
        upc_extra_parts="upc-crtbegin.o upc-crtend.o"
	;;
  i[56]86-*-linux*)
  	# cfiles="${cfiles} i386/upc-linux.h"
	;;
  mips-sgi-irix6*)
  	# cfiles="${cfiles} mips/upc-iris6.h"
        upc_extra_parts="upc-crtbegin.o upc-crtend.o"
	;;
  ia64-*-linux*)
  	# cfiles="${cfiles} ia64/upc-linux.h"
	;;
  x86_64-*-linux*)
  	# cfiles="${cfiles} i386/upc-linux.h"
	;;
  x86_64-*-darwin*)
	# cfiles="${cfiles} i386/upc-linux.h"
	upc_extra_parts="upc-crtbegin.o upc-crtend.o"
	;;
  *)
	echo "UPC has not been configured for ${build}." >&2
        exit 2
	;;
  esac 
  extra_parts="${extra_parts} ${upc_extra_parts}"
  case $v in
  *file*)
  	cfiles=`echo $cfiles | sed -e 's=config/=\$(srcdir)/config/=g'`
  	;;
  *) ;;
  esac
  eval "${v}=\`echo \$${v} | sed -e 's=[^ ]*defaults.h= ${cfiles} &='\`"
done
